{% load static %}
{% load debug_tags %}
<!DOCTYPE html>
<html>
<head>
	{% if not page_info and DEBUG %}
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			setTimeout(function() { alert(
				'Ошибка! page_info отсутствует в контексте! ' +
				'Бекендеры, проверьте что используете правильный View, ' +
				'добавляющий page_info в контекст!'
			)}, 200);
		});
	</script>
	{% endif %}

	{% block html_title_override %}
		<!-- Подразумевается, что page_info.html_title будет всегда -->
		<title>{{ page_info.html_title|default:global.site_settings.site_name }}</title>
	{% endblock %}

	<meta name="description" content="Description">
	<meta name="og:type" content="{{page_info.og_type}}">
	{% block custom_og_tags %}{% endblock %}
	<meta name="og:title" content="{{page_info.og_title}}">
	{% if page_info.og_description %}
		<meta name="og:description" content="{{page_info.og_description}}">{% endif %}
	{% if page_info.og_image_url or global.site_settings.favicon %}
		<meta name="og:image" content="{{page_info.og_image_url|default:global.site_settings.favicon.url}}">
	{% endif %}
	<meta name="og:site_name" content="{{site_settings.site_name}}">
	<meta name="og:url" content="{{page_info.get_absolute_url}}">
	<link rel="cannonical" href="{{page_info.get_absolute_url}}">

	<meta charset="utf-8">
	{% with microdata=page_info.get_microdata_dumped %}
		{% if microdata %}
			<script type="application/ld+json">{{microdata}}</script>{% endif %}{% endwith %}

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
	<script>{{ global.site_settings.head_script|safe }}</script>
</head>
<style>
	:root {
		font-family: 'JetBrains Mono', 'Segoe UI', system-ui;
		background-color: #292a2d;
		color: white;

		--light-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		--dark-bg: #0000001F;
	}

	::selection {
		background-color: rgba(127, 127, 127, 0.7);
	}

	html {
		height: 100%;
	}

	body {
		display: flex;
		flex-direction: column;
		height: 100%;
		margin: 0;
	}

	.content {
		display: flex;
		flex-direction: column;
		flex: 1;
		padding: 0.5rem;
	}

	main {
		flex: 1;
		display: flex;
		align-items: center;
		flex-direction: column;
		gap: 1rem;
	}

	hr {
		border: none;
		background-color: #525252;
		height: 0.1rem;
		border-radius: 9999rem;
	}

	a {
		color: #3B82F6;
		text-decoration: none;
	} a:hover {
		text-decoration: underline;
	} a:visited {
		color: #3B82F6;
	}

	h1, h2, h3, h4 {
		margin-bottom: 0.125rem;
		margin-top: 0.5rem;
	}
	footer h4 {
		margin-bottom: 0.5rem;
		margin-top: 0.25rem;
	}

	footer {
		margin-top: 1rem;
		padding-bottom: 2rem;
	}

	code {
		font-size: 1rem;
		background-color: #424242;
		padding-inline: 0.5rem;
		border-radius: 0.25rem;
	}

	table { border-collapse: collapse; margin: 10px 0; }
	td, th { border: 1px solid #ddd; padding: 4px 8px; }
	th { background-color: var(--dark-bg); }

	form {
		display: flex;
		flex-direction: column;
		gap: 0.8rem;
	}
	form div {
		display: flex;
		flex-direction: column;
		justify-content: space-between;
	}
	form input {
		min-width: 18rem;
		font-family: inherit;
		background-color: white;
		border: none;
		padding-inline: 0.5rem;
		padding-block: 0.125rem;
		border-radius: 0.25rem;
		font-weight: inherit;
	}

	button {
		font-size: inherit;
		font-family: inherit;
		border: none;
		background-color: #4d6bfe;
		padding: 0.2rem 0.8rem;
		color: white;
		border-radius: 0.4rem;
		text-decoration: none;
		font-weight: 500;
		transition: background-color 0.2s;
	}
	button:hover {
		text-decoration: none;
		background-color: #4d6bfeD0;
	}

	.button-like a {
		background-color: #4d6bfe;
		padding: 0.2rem 0.8rem;
		color: white;
		border-radius: 0.4rem;
		text-decoration: none;
		font-weight: 500;
		transition: background-color 0.2s;
	}
	.button-like a:hover {
		text-decoration: none;
		background-color: #4d6bfeD0;
	}
	.button-like a.green { background-color: #4CAF50; }
	.button-like a.green:hover { background-color: #4CAF50D0; }

	.button-like a.gray { background-color: #3a3c40; }
	.button-like a.gray:hover { background-color: #4d6bfeD0; }

	.dark-shell {
		display: flex;
		flex-direction: column;
		gap: 0.8rem;
		padding: 1.2rem;
		border-radius: 1rem;
		background-color: var(--dark-bg);
		box-shadow: var(--light-shadow);
	}

	.invisible-link {
		color: indigo;
		text-decoration: none;
	}

	.invisible-link:hover {
		text-decoration: none;
	}

	.warn-info-block {
		color: yellow;
		font-size: 0.75rem;
		background-color: var(--dark-bg);
		border: 0.1rem solid var(--dark-bg);
		padding: 0.25rem;
		margin-bottom: 0.5rem;
	}

	.path-row {
		color: darkgray;
		margin-top: 0.5rem;
		margin-right: auto;
		display: flex;

		a {
			color: darkgray;
			transition: 0.6s;
		}
		a:hover {
			color: grey;
			text-decoration: none;
			transition: 0.6s;
		}
	}

	::-webkit-scrollbar {
		height: 0.5rem;
	}
	
	::-webkit-scrollbar-track {
		background: var(--dark-bg);
		border-radius: 999rem;
	}
	
	::-webkit-scrollbar-thumb {
		background: #5a5a5af0;
		border-radius: 999rem;
	}
</style>
<style>
	/* ВЫПАДАЮЩЕЕ МЕНЮ - ИСПРАВЛЕННАЯ ВЕРСИЯ */
	.dropdown {
		position: relative;
		display: inline-block;
	}

	.dropdown-toggle {
		background-color: #4d6bfe;
		color: white;
		border-radius: 0.4rem;
		text-decoration: none;
		font-weight: 500;
		cursor: pointer;
		display: inline-flex;
		align-items: center;
	}

	.dropdown-toggle:hover {
		background-color: #4d6bfeD0;
		text-decoration: none;
	}

	.dropdown-menu {
		display: none;
		position: absolute;
		top: calc(100% + 1px);
		left: 0;
		background-color: #292a2d;
		border-radius: 0.4rem;
		padding: 0.5rem;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
		z-index: 1000;
		min-width: 160px;
		max-height: 70vh;
		overflow-y: auto;
		grid-template-columns: 1fr;
		gap: 0.3rem;
	}

	.dropdown:hover .dropdown-menu,
	.dropdown-menu:hover {
		display: grid;
	}

	.dropdown-menu a {
		display: block;
		padding: 0.3rem 0.8rem;
		background-color: #3a3c40;
		border-radius: 0.3rem;
		white-space: nowrap;
		transition: background-color 0.2s;
	}

	.dropdown-menu a:hover {
		background-color: #4d6bfe;
		text-decoration: none;
	}

	.dropdown-menu.right-edge {
		left: auto;
		right: 0;
	}
</style>
<body>
	<div class="content">
		<div style="display: flex; justify-content: space-between; align-items: stretch;">
			<div style="align-self: center;">
				Вы на странице:&nbsp<code>{{ page_info.name }}</code>&nbsp|
				URL:&nbsp<code>{{ page_info.get_absolute_url }}</code>&nbsp|
				Slug:&nbsp<code>{{ page_info.slug }}</code>&nbsp|
				{% if object.template_name %}
				Template:&nbsp<code>{{ object.template_name }}</code>&nbsp|
				{% endif %}
				View:&nbsp<code>{{ view|typename }}</code>
				</code>
			</div>
			<div class="button-like" style="display: flex; gap: 0.5rem; align-items: flex-start; flex-shrink: 0;">
				{% comment %}
				чтобы если нет page_info можно было сразу перейти в админку, а так
				page_info гарантируется на каждой странице.
				{% endcomment %}
				<a href="{{page_info.get_admin_url|default:'/admin/'}}" class="button-like green">
					→ Смотреть в админке
				</a>
				<div class="dropdown">
					<a class="dropdown-toggle">Страницы ▼</a>
					<div class="dropdown-menu right-edge">
						{% with index=global.pages.index %}
							<a href="{{ index.get_absolute_url }}">{{ index.name|truncatechars:18 }}</a>
							<div><hr style="margin: 0;"></div>

							{% for g_page in global.pages.values %}
								{% if g_page != index %}
								<a href="{{ g_page.get_absolute_url }}">{{ g_page|truncatechars:18 }}</a>
								{% endif %}
							{% endfor %}
						{% endwith %}
					</div>
				</div>
			</div>
		</div>
		<div><hr></div>
		<main>
			{% block content %}
				<div>Тут пусто. Ага.</div>
				<div style="color: gray; font-size: 0.75rem;">(наполнение content по умолчанию)</div>
				<style>
					main {
						justify-content: center;
						gap: 0;
					}
				</style>
			{% endblock %}
		</main>
		<footer>
			<hr>
			<div style="display: flex; justify-content: center; gap: 4rem;">
				<a href="/">
					{% if global.site_settings.favicon %}
					<img src="{{ global.site_settings.favicon.url }}" style="height: 40%; border-radius: 0;">
					{% else %}
					<div style="background-color: gray; aspect-ratio: 1; height: 40%; border-radius: 0.5rem;"></div>
					{% endif %}
				</a>
				<div>
					<h4>Товары</h4>
					{% for category in global.categories %}
						<div>
							<a href="{{ category.get_absolute_url }}">{{ category.name }}</a>
						</div>
					{% endfor %}
				</div>
				<div>
					<h4>Услуги</h4>
					{% for service in global.services %}
						<div>
							<a href="{{ service.get_absolute_url }}">{{ service.name }}</a>
						</div>
					{% endfor %}
				</div>
				<div>
					<h4>О компании</h4>
					<div>
						<a href="{{ global.pages.company_contacts.get_absolute_url }}">
							{{ global.pages.company_contacts.name }}
						</a>
					</div>
					<div>
						<a href="{{ global.pages.about_us.get_absolute_url }}">
							{{ global.pages.about_us.name }}
						</a>
					</div>
				</div>
				<div>
					<div>
						Время работы: {{ global.company_contacts.work_time_text }}
					</div>
					<hr>
					<div>
						Почта: {{ global.company_contacts.email }}
					</div>
					<hr>
					<div>
						Адрес: {{ global.company_contacts.addres }}
					</div>
					<hr>
					<div>
						{{ global.company_contacts.first_phone_number }} |
						{{ global.company_contacts.secondary_phone_number }}
					</div>
				</div>
			</div>
			<div style="margin-top: 1rem; display: flex; gap: 2rem; justify-content: center;">
				<a style="opacity: 0.5;" href="{{global.pages.privacy_policy.get_absolute_url}}">{{global.pages.privacy_policy.name}}</a>
				<a style="opacity: 0.5;" href="{{global.pages.cookie_policy.get_absolute_url}}">{{global.pages.cookie_policy.name}}</a>
			</div>
		</footer>
	</div>
</body>
</html>
